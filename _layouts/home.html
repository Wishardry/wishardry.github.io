---
layout: default
---

<div class="home">
  {%- if page.title -%}
    <h1 class="page-heading">{{ page.title }}</h1>
  {%- endif -%}

  {{ content }}

  {%- if site.pinned_posts and site.pinned_posts.size > 0 -%}
    <h2>Pinned Posts</h2>
    
    <ul class="post-list pinned-list">
      {%- for pinned_url in site.pinned_posts -%}
        {%- for post in site.posts -%}
          {%- if post.url == pinned_url -%}
          <li>
            <a href="{{ post.url | relative_url }}" class="post-card pinned-card">
              <div class="post-header">
                <h3 class="post-link">ðŸ“Œ {{ post.title | escape }}</h3>
                <span class="post-meta">{{ post.date | date: "%B %-d, %Y" }}</span>
              </div>
              <div class="post-excerpt">
                {{ post.excerpt | strip_html | truncatewords: 50 }}
              </div>
            </a>
          </li>
          {%- break -%}
          {%- endif -%}
        {%- endfor -%}
      {%- endfor -%}
    </ul>
  {%- endif -%}

  {%- if site.posts.size > 0 -%}
    <h2>Recent Posts</h2>
    
    <ul class="post-list" id="post-list">
      {%- assign displayed_count = 0 -%}
      {%- for post in site.posts -%}
        {%- assign is_pinned = false -%}
        {%- for pinned_url in site.pinned_posts -%}
          {%- if post.url == pinned_url -%}
            {%- assign is_pinned = true -%}
            {%- break -%}
          {%- endif -%}
        {%- endfor -%}
        {%- unless is_pinned -%}
          {%- if displayed_count < 8 -%}
          <li>
            <a href="{{ post.url | relative_url }}" class="post-card">
              <div class="post-header">
                <h3 class="post-link">{{ post.title | escape }}</h3>
                <span class="post-meta">{{ post.date | date: "%B %-d, %Y" }}</span>
              </div>
              <div class="post-excerpt">
                {{ post.excerpt | strip_html | truncatewords: 50 }}
              </div>
            </a>
          </li>
          {%- assign displayed_count = displayed_count | plus: 1 -%}
          {%- endif -%}
        {%- endunless -%}
      {%- endfor -%}
    </ul>
    
    {%- assign remaining_posts = site.posts.size -%}
    {%- if site.pinned_posts -%}
      {%- assign remaining_posts = remaining_posts | minus: site.pinned_posts.size -%}
    {%- endif -%}
    {%- if remaining_posts > 8 -%}
    <div class="load-more-container">
      <button class="load-more-btn" onclick="loadMorePosts()">Load More Posts</button>
    </div>
    {%- endif -%}
  {%- endif -%}

</div>

<script>
  let currentPostCount = 8;
  const postsPerLoad = 8;
  const pinnedUrls = [
    {%- for pinned_url in site.pinned_posts -%}
    {{ pinned_url | jsonify }}{%- unless forloop.last -%},{%- endunless -%}
    {%- endfor -%}
  ];
  const allPosts = [
    {%- assign skip_count = 0 -%}
    {%- for post in site.posts -%}
      {%- assign is_pinned = false -%}
      {%- for pinned_url in site.pinned_posts -%}
        {%- if post.url == pinned_url -%}
          {%- assign is_pinned = true -%}
          {%- break -%}
        {%- endif -%}
      {%- endfor -%}
      {%- unless is_pinned -%}
        {%- if skip_count >= 8 -%}
        {
          title: {{ post.title | jsonify }},
          url: {{ post.url | relative_url | jsonify }},
          date: {{ post.date | date: "%B %-d, %Y" | jsonify }},
          excerpt: {{ post.excerpt | strip_html | truncatewords: 50 | jsonify }}
        }{%- unless forloop.last -%},{%- endunless -%}
        {%- endif -%}
        {%- assign skip_count = skip_count | plus: 1 -%}
      {%- endunless -%}
    {%- endfor -%}
  ];
  
  function loadMorePosts() {
    const postList = document.getElementById('post-list');
    const loadMoreBtn = document.querySelector('.load-more-btn');
    const endIndex = Math.min(currentPostCount + postsPerLoad - 8, allPosts.length);
    
    for (let i = 0; i < endIndex && currentPostCount - 8 < allPosts.length; i++) {
      const post = allPosts[currentPostCount - 8];
      const li = document.createElement('li');
      li.innerHTML = `
        <a href="${post.url}" class="post-card">
          <div class="post-header">
            <h3 class="post-link">${post.title}</h3>
            <span class="post-meta">${post.date}</span>
          </div>
          <div class="post-excerpt">
            ${post.excerpt}
          </div>
        </a>
      `;
      postList.appendChild(li);
      currentPostCount++;
    }
    
    if (currentPostCount - 8 >= allPosts.length) {
      loadMoreBtn.style.display = 'none';
    }
  }
</script>
